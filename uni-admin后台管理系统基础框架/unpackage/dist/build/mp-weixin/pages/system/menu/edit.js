"use strict";const e=require("../../../common/vendor.js"),o=require("../../../js_sdk/validator/opendb-admin-menus.js"),n=e.er.database();n.command;function a(e){let n={};for(let a in o.validator)e.includes(a)&&(n[a]=o.validator[a]);return n}const i={components:{Icons:()=>"../../demo/icons/icons2.js"},data:()=>({formData:{menu_id:"",name:"",icon:"",url:"",sort:"",parent_id:"",permission:[],enable:null},rules:{...a(["menu_id","name","icon","url","sort","parent_id","permission","enable"])}}),onLoad(e){const o=e.id;this.formDataId=o,this.getDetail(o)},methods:{submitForm(e){this.$refs.form.submit()},submit(o){const{value:a,errors:i}=o.detail;i||(e.index.showLoading({title:"修改中...",mask:!0}),n.collection("opendb-admin-menus").doc(this.formDataId).update(a).then((o=>{e.index.showToast({title:"修改成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>e.index.navigateBack()),500)})).catch((o=>{e.index.showModal({content:o.message||"请求服务失败",showCancel:!1})})).finally((()=>{e.index.hideLoading()})))},getDetail(o){e.index.showLoading({mask:!0}),n.collection("opendb-admin-menus").where({_id:o}).get().then((e=>{const o=e.result.data[0];o&&(this.formData=o)})).catch((o=>{e.index.showModal({content:o.message||"请求服务失败",showCancel:!1})})).finally((()=>{e.index.hideLoading()}))},showIconPopup(){this.$refs.iconPopup.open()}}};if(!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-link")+e.resolveComponent("uni-data-checkbox")+e.resolveComponent("Icons")+e.resolveComponent("uni-popup")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../../uni_modules/uni-link/components/uni-link/uni-link.js")+(()=>"../../../uni_modules/uni-data-checkbox/components/uni-data-checkbox/uni-data-checkbox.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms/uni-forms.js"))();const t=e._export_sfc(i,[["render",function(o,n,a,i,t,s){return{a:e.o((e=>t.formData.menu_id=e)),b:e.p({clearable:!1,placeholder:"请输入菜单项的ID，不可重复",modelValue:t.formData.menu_id}),c:e.p({name:"menu_id",label:"标识",required:!0}),d:e.o((e=>t.formData.name=e)),e:e.p({clearable:!1,placeholder:"请输入菜单名称",modelValue:t.formData.name}),f:e.p({name:"name",label:"显示名称",required:!0}),g:e.o(((...e)=>s.showIconPopup&&s.showIconPopup(...e))),h:e.o((e=>t.formData.icon=e)),i:e.p({clearable:!1,placeholder:"请输入菜单图标css样式类名",modelValue:t.formData.icon}),j:e.p({"font-size":"12",href:"https://uniapp.dcloud.net.cn/uniCloud/admin?id=icon-%e5%9b%be%e6%a0%87",text:"如何使用自定义图标？"}),k:e.p({name:"icon",label:"图标 class"}),l:e.o((e=>t.formData.url=e)),m:e.p({clearable:!1,placeholder:"URL必须是/开头，URL为空代表是目录而不是叶子节点",modelValue:t.formData.url}),n:e.p({name:"url",label:"页面URL"}),o:e.o((e=>t.formData.sort=e)),p:e.p({clearable:!1,placeholder:"请输入菜单序号（越大越靠后）",modelValue:t.formData.sort}),q:e.p({name:"sort",label:"序号"}),r:e.o((e=>t.formData.parent_id=e)),s:e.p({clearable:!1,placeholder:"请输入父级菜单标识, 一级菜单不需要填写",modelValue:t.formData.parent_id}),t:e.p({name:"parent_id",label:"父菜单标识"}),v:e.o((e=>t.formData.permission=e)),w:e.p({multiple:!0,collection:"uni-id-permissions","page-size":500,field:"permission_name as text, permission_id as value",modelValue:t.formData.permission}),x:e.p({name:"permission",label:"权限列表"}),y:e.o((e=>o.binddata("enable",e.detail.value))),z:t.formData.enable,A:e.p({name:"enable",label:"是否启用"}),B:e.t(o.$t("common.button.submit")),C:e.o(((...e)=>s.submitForm&&s.submitForm(...e))),D:e.t(o.$t("common.button.back")),E:e.p({tag:!1,"fix-window":!1}),F:e.sr("iconPopup","44dcf2da-17,44dcf2da-0"),G:e.p({type:"center"}),H:e.sr("form","44dcf2da-0"),I:e.o(s.submit),J:e.o((e=>t.formData=e)),K:e.p({labelWidth:"80",rules:t.rules,validateTrigger:"bind",modelValue:t.formData})}}],["__scopeId","data-v-44dcf2da"]]);wx.createPage(t);
