"use strict";const e=require("../../../common/vendor.js"),i=require("../../../js_sdk/validator/uni-id-permissions.js"),n=e.er.database();n.command;function o(e){let n={};for(let o in i.validator)e.includes(o)&&(n[o]=i.validator[o]);return n}const t={data(){let e={permission_id:"",permission_name:"",comment:""};return{formData:e,formOptions:{},rules:{...o(Object.keys(e))}}},onLoad(e){if(e.id){const i=e.id;this.formDataId=i,this.getDetail(i)}},onReady(){this.$refs.form.setRules(this.rules)},methods:{submit(){e.index.showLoading({mask:!0}),this.$refs.form.validate().then((e=>{this.submitForm(e)})).catch((()=>{e.index.hideLoading()}))},submitForm(i){n.collection("uni-id-permissions").doc(this.formDataId).update(i).then((i=>{e.index.showToast({title:"修改成功"}),this.getOpenerEventChannel().emit("refreshData"),setTimeout((()=>e.index.navigateBack()),500)})).catch((i=>{e.index.showModal({content:i.message||"请求服务失败",showCancel:!1})})).finally((()=>{e.index.hideLoading()}))},getDetail(i){e.index.showLoading({mask:!0}),n.collection("uni-id-permissions").doc(i).field("permission_id,permission_name,comment").get().then((e=>{const i=e.result.data[0];i&&(this.formData=i)})).catch((i=>{e.index.showModal({content:i.message||"请求服务失败",showCancel:!1})})).finally((()=>{e.index.hideLoading()}))}}};if(!Array){(e.resolveComponent("uni-easyinput")+e.resolveComponent("uni-forms-item")+e.resolveComponent("uni-forms"))()}Math||((()=>"../../../uni_modules/uni-easyinput/components/uni-easyinput/uni-easyinput.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms-item/uni-forms-item.js")+(()=>"../../../uni_modules/uni-forms/components/uni-forms/uni-forms.js"))();const s=e._export_sfc(t,[["render",function(i,n,o,t,s,a){return{a:e.o((e=>i.binddata("permission_id",e.detail.value))),b:e.o((e=>s.formData.permission_id=e)),c:e.p({placeholder:"权限唯一标识，不可修改，不允许重复",trim:"both",disabled:!0,modelValue:s.formData.permission_id}),d:e.p({name:"permission_id",label:"权限ID",required:!0}),e:e.o([e=>s.formData.permission_name=e.detail.value,e=>i.binddata("permission_name",e.detail.value)]),f:s.formData.permission_name,g:e.p({name:"permission_name",label:"权限名称",required:!0}),h:e.o([e=>s.formData.comment=e.detail.value,e=>i.binddata("comment",e.detail.value)]),i:s.formData.comment,j:e.p({name:"comment",label:"备注"}),k:e.t(i.$t("common.button.submit")),l:e.o(((...e)=>a.submit&&a.submit(...e))),m:e.t(i.$t("common.button.back")),n:e.sr("form","ec79134e-0"),o:e.p({value:s.formData,validateTrigger:"bind"})}}]]);wx.createPage(s);
